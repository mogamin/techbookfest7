CuPy-AMD
========

## 1. Build a Docker image

(If you haven't installed Docker itself, install it first)

```bash
sudo docker build -t cupy-amd .
```

## 2. Try CuPy on AMD GPUs


### Run a small example of CuPy

```bash
docker run --rm -ti \
--device=/dev/kfd \
--device=/dev/dri \
--group-add video \
cupy-amd \
python3 cupy/examples/gemm/sgemm.py
```

### Run the MNIST example on Vega 10 GPU

```bash
docker run --rm -ti \
--device=/dev/kfd \
--device=/dev/dri \
--group-add video \
cupy-amd \
python3 chainer/examples/mnist/train_mnist.py -g 0
```

Output:
```
Device: @cupy:0
# unit: 1000
# Minibatch-size: 100
# epoch: 20

epoch       main/loss   validation/main/loss  main/accuracy  validation/main/accuracy  elapsed_time
1           0.190636    0.100948              0.942666       0.9677                    15.613        
2           0.0735354   0.0831429             0.976816       0.9755                    19.5049       
3           0.0486293   0.0982996             0.983982       0.9705                    23.2567       
4           0.0344671   0.0795409             0.988382       0.9791                    27.021        
5           0.0287373   0.0921614             0.990382       0.9744                    30.7505       
6           0.0219301   0.0753978             0.992898       0.9818                    34.3199       
7           0.0214624   0.0855713             0.993198       0.9783                    37.8751       
8           0.0199715   0.0816516             0.993682       0.9794                    41.4411       
9           0.0168919   0.0935069             0.994349       0.9768                    45.2084       
10          0.0135988   0.0818315             0.995699       0.9821                    49.1504       
11          0.0136192   0.0942346             0.995849       0.98                      53.8472       
12          0.0125953   0.076644              0.996132       0.9831                    58.0597       
13          0.0128217   0.103026              0.996148       0.9789                    61.9693       
14          0.0117914   0.10983               0.996399       0.9768                    65.8733       
15          0.0124237   0.089913              0.996299       0.9828                    69.4946       
16          0.0124355   0.0875289             0.996016       0.9838                    73.4675       
17          0.00631631  0.115091              0.998166       0.9781                    77.1032       
18          0.0114436   0.112791              0.996715       0.98                      81.0499       
19          0.0101224   0.0991214             0.997132       0.9818                    85.0017       
20          0.00896638  0.0794532             0.997366       0.9859                    89.7187       
```

### Run the MNIST example on a CPU

```bash
docker run --rm -ti \
--device=/dev/kfd \
--device=/dev/dri \
--group-add video \
cupy-amd \
python3 chainer/examples/mnist/train_mnist.py
```

Output:
```
Device: @numpy
# unit: 1000
# Minibatch-size: 100
# epoch: 20

epoch       main/loss   validation/main/loss  main/accuracy  validation/main/accuracy  elapsed_time
1           0.193647    0.0847369             0.940733       0.9728                    20.6528       
2           0.0725483   0.0788171             0.977067       0.9748                    46.629        
3           0.0487089   0.0890043             0.98465        0.9733                    75.0325       
4           0.0364456   0.0664886             0.988383       0.9812                    103.848       
5           0.0286224   0.0751955             0.99095        0.9808                    133.97        
6           0.0248378   0.0916668             0.991867       0.9761                    165.852       
7           0.0212888   0.126492              0.993033       0.9691                    197.253       
8           0.0198773   0.0875681             0.993467       0.9783                    229.812       
9           0.012683    0.0946795             0.995483       0.9792                    262.577       
10          0.0151458   0.111274              0.995233       0.9783                    295.817       
11          0.0181055   0.081226              0.9945         0.98                      330.855       
12          0.00886062  0.0938567             0.997133       0.9809                    367.424       
13          0.0125751   0.105831              0.9959         0.9781                    404.635       
14          0.0149673   0.0880483             0.995517       0.983                     442.027       
15          0.00703046  0.0901549             0.998017       0.9826                    482.734       
16          0.00903746  0.103938              0.99715        0.9796                    524.314       
17          0.0124398   0.0979193             0.996267       0.9819                    566.06        
18          0.00602807  0.0878252             0.9981         0.9839                    608.965       
19          0.010553    0.117189              0.997133       0.9806                    651.303       
20          0.011329    0.0932423             0.996667       0.9853                    694.38        
```